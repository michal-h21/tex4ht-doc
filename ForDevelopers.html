<!DOCTYPE html> 
<html lang='en' xml:lang='en'> 
<head><title>10 For Developers</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='tex4ht-doc.css' rel='stylesheet' type='text/css' /> 
<meta content='tex4ht-doc.tex' name='src' /> 
<link href='style.css' rel='stylesheet' type='text/css' /> 
</head><body>
<nav class='TOC'>   
<span class='chapterToc'>1 <a href='Introduction.html#introduction'>Introduction</a></span>

<span class='chapterToc'>2 <a href='BasicTutorial.html#basic-tutorial'>Basic Tutorial</a></span>













<span class='chapterToc'>3 <a href='Howto.html#how-to'>How to</a></span>























<span class='chapterToc'>4 <a href='CallingCommands.html#calling-commands'>Calling Commands</a></span>



                                                                  

                                                                  




<span class='chapterToc'>5 <a href='OutputFormats.html#output-formats'>Output Formats</a></span>
<span class='chapterToc'>6 <a href='texfourhtOptions.html#texht-options1'><code class='texttt'>TeX4ht</code> Options</a></span>


<span class='chapterToc'>7 <a href='Configurations.html#configurations2'>Configurations</a></span>





































                                                                  

                                                                  











<span class='chapterToc'>8 <a href='Make4htBuildFiles.html#makeht-build-files'>Make4ht Build Files</a></span>



<span class='chapterToc'>9 <a href='FAQandTroubleshooting.html#faq-and-troubleshooting'>FAQ and Troubleshooting</a></span>







<span class='chapterToc'>10 <a href='#for-developers'>For Developers</a></span>
<span class='sectionToc'>10.1 <a href='#tutorial-basic-support-for-a-new-package'>Tutorial: Basic Support For a New Package</a></span>
<span class='sectionToc'>10.2 <a href='#commands-usable-in-the-ht-files'>Commands Usable in the <code class='texttt'>.4ht</code> files</a></span>
<span class='sectionToc'>10.3 <a href='#two-types-of-ht-files'>Two types of .4ht files</a></span>
<span class='subsectionToc'>10.3.1 <a href='#custom-output-formats1'>Custom output formats</a></span>
<span class='sectionToc'>10.4 <a href='#early-hooks-in-usepackageht'>Early Hooks in usepackage.4ht</a></span>
<span class='subsectionToc'>10.4.1 <a href='#execute-code-directly-in-usepackageht'>Execute Code Directly in usepackage.4ht</a></span>
<span class='sectionToc'>10.5 <a href='#texht-literate-sources'><code class='texttt'>TeX4ht</code> literate sources</a></span>
<span class='subsectionToc'>10.5.1 <a href='#how-to-add-support-for-a-package-to-the-texht-literate-sources'>How to add support for a package to the <code class='texttt'>TeX4ht</code> literate sources</a></span>
<span class='sectionToc'>10.6 <a href='#protex'>ProTeX</a></span>
<span class='chapterToc'>11 <a href='Glossary.html#glossary'>Glossary</a></span>
<span class='chapterToc'>12 <a href='Bibliography.html#bibliography'>Bibliography</a></span>
<span class='chapterToc'>13 <a href='Index.html#index'>Index</a></span>
<span class='chapterToc'>14 <a href='Changes.html#changes'>Changes</a></span>
 
   
</nav> 
<main class='main-content'> 
<nav class='crosslinks-top'> [<a href='FAQandTroubleshooting.html'>prev</a>] [<a href='tex4ht-doc.html#ForDevelopers.html'>up</a>] [<a href='Glossary.html'>next</a>] </nav> 
<h2 class='chapterHead' id='for-developers'><span class='titlemark'>Chapter 10</span><br /><a id='x11-12100010'></a>For Developers</h2>
This chapter deals with <code class='texttt'>TeX4ht</code> development. It starts with a basic tutorial for a
new package support, shows commands useful in the process, different types of
<code class='texttt'>TeX4ht</code> configuration files, and the syntax and structure of literate source
files.

                                                                  

                                                                  
<h3 class='sectionHead' id='tutorial-basic-support-for-a-new-package'><span class='titlemark'>10.1   </span> <a id='x11-12200010.1'></a>Tutorial: Basic Support For a New Package</h3>
<!--  l. 10  --><p class='noindent'>In this tutorial, we will try to show how to provide <code class='texttt'>TeX4ht</code> support for a simple
LaTeX package.
</p><!--  l. 14  --><p class='indent'>   <code class='texttt'>TeX4ht</code> tries to load a special <code class='texttt'>.4ht</code> file for each package loaded by LaTeX. This
special file can contain modifications to commands provided by the package, like
redefinitions of macros that cause clashes between the package and <code class='texttt'>TeX4ht</code>, and most
importantly they insert special macros, called hooks, that are then used to include
the output format tags.
</p><!--  l. 19  --><p class='indent'>   Let’s say that you have a custom package, called <code class='texttt'>mynote.sty</code>
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb180'><a id='x11-122006r1'></a><span style='color:rgb(40,56,175);'>\newcommand\notetitle</span><span style='color:rgb(56,127,56);'>{</span>Note:~<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122008r2'></a><span style='color:rgb(40,56,175);'>\newcommand\note</span><span style='color:rgb(56,127,56);'>[1]{</span><span style='color:rgb(40,56,175);'>\textbf</span><span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\notetitle</span><span style='color:rgb(56,127,56);'>}</span>#1<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122010r3'></a><span style='color:rgb(40,56,175);'>\newcommand\highlight</span><span style='color:rgb(56,127,56);'>[1]{</span><span style='color:rgb(40,56,175);'>\textbf</span><span style='color:rgb(56,127,56);'>{</span>#1<span style='color:rgb(56,127,56);'>}}</span> 
<a id='x11-122012r4'></a><span style='color:rgb(40,56,175);'>\endinput</span></pre>

</figure>
<!--  l. 28  --><p class='indent'>   It defines two user commands, <span class='textbf'><code class='texttt'>\note</code></span> and <span class='textbf'><code class='texttt'>\highlight</code></span>. They can be used in the
following way:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb181'><a id='x11-122021r1'></a><span style='color:rgb(40,56,175);'>\documentclass</span><span style='color:rgb(56,127,56);'>{</span>article<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122023r2'></a><span style='color:rgb(40,56,175);'>\usepackage</span><span style='color:rgb(56,127,56);'>{</span>mynote<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122025r3'></a><span style='color:rgb(40,56,175);'>\begin</span><span style='color:rgb(56,127,56);'>{</span>document<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122027r4'></a><span style='color:rgb(40,56,175);'>\note</span><span style='color:rgb(56,127,56);'>{</span>This is a note<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122029r5'></a> 
<a id='x11-122031r6'></a>Try to highlight <span style='color:rgb(40,56,175);'>\highlight</span><span style='color:rgb(56,127,56);'>{</span>something<span style='color:rgb(56,127,56);'>}</span>. 
<a id='x11-122033r7'></a><span style='color:rgb(40,56,175);'>\end</span><span style='color:rgb(56,127,56);'>{</span>document<span style='color:rgb(56,127,56);'>}</span></pre>

</figure>
<!--  l. 42  --><p class='indent'>   <code class='texttt'>TeX4ht</code> produces usable output for both of these commands out of the box,
thanks to the support for TeX fonts. But you may want to use custom HTML tags
instead. To achieve that, you need to insert special commands, called hooks in
<code class='texttt'>TeX4ht</code>, to package commands. These hooks can be then configured to insert tags in
the output format.
</p><!--  l. 48  --><p class='indent'>   To introduce hooks, you need to create a hook seeding configuration file for the
package, called <code class='texttt'>&lt;name&gt;.4ht</code>. For example, to seed hooks for the <code class='texttt'>mynote.sty</code> package,
create file <code class='texttt'>mynote.4ht</code>:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb182'><a id='x11-122047r1'></a><span style='color:rgb(40,56,175);'>\NewConfigure</span><span style='color:rgb(56,127,56);'>{</span>note<span style='color:rgb(56,127,56);'>}{</span>3<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122049r2'></a> 
<a id='x11-122051r3'></a><span style='color:rgb(135,135,135);'><span class='textit'>% Use \HLet when you want to completely redefine a command</span></span> 
<a id='x11-122053r4'></a><span style='color:rgb(40,56,175);'>\def\:tempa</span>#1<span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\a:note\notetitle\b:note</span>~#1<span style='color:rgb(40,56,175);'>\c:note</span><span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122055r5'></a><span style='color:rgb(40,56,175);'>\HLet\note\:tempa</span> 
<a id='x11-122057r6'></a> 
<a id='x11-122059r7'></a><span style='color:rgb(40,56,175);'>\NewConfigure</span><span style='color:rgb(56,127,56);'>{</span>highlight<span style='color:rgb(56,127,56);'>}{</span>2<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122061r8'></a><span style='color:rgb(40,56,175);'>\pend:defI\highlight</span><span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\a:highlight</span><span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122063r9'></a><span style='color:rgb(40,56,175);'>\append:defI\highlight</span><span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\b:highlight</span><span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122065r10'></a> 
<a id='x11-122067r11'></a><span style='color:rgb(40,56,175);'>\Hinput</span><span style='color:rgb(56,127,56);'>{</span>mynote<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122069r12'></a><span style='color:rgb(40,56,175);'>\endinput</span></pre>

</figure>
<!--  l. 67  --><p class='indent'>   There is several things to note. First is that the <span class='obeylines-h'><code class='verb'>:</code></span> character can be included as a
part of a command name in <code class='texttt'>.4ht</code> files. It is similar to use of the <span class='obeylines-h'><code class='verb'>@</code></span> character in LaTeX
packages. It allows us to create command names that don’t clash with other
command names.
</p><!--  l. 72  --><p class='indent'>   The hooks are created using the <span class='textbf'><code class='texttt'>\NewConfigure</code></span> command. They can be later
filled with the <span class='textbf'><code class='texttt'>\Configure</code></span> command. To have an effect, hooks must be
inserted to the existing commands. There are two ways how to do that. For
simpler commands, where we want to insert tags only before and after the
contents produced by the patched command, we can use the <span class='textbf'><code class='texttt'>\pend:def&lt;X&gt;</code></span> and
<span class='textbf'><code class='texttt'>\append:def&lt;X&gt;</code></span> commands, where the <span class='obeylines-h'><code class='verb'>&lt;X&gt;</code></span> is a roman number of parameters that
                                                                  

                                                                  
the patched command expects. In this example, it expects one parameter, so we
can use the <span class='textbf'><code class='texttt'>\pend:defI</code></span> command. For commands without parameters, use
<span class='textbf'><code class='texttt'>\pend:def</code></span>.
</p><!--  l. 82  --><p class='indent'>   Of course, you can also insert hooks using other mechanisms, for example using
LaTeX’s hook system:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb183'><a id='x11-122073r1'></a><span style='color:rgb(40,56,175);'>\AddToHook</span><span style='color:rgb(56,127,56);'>{</span>cmd/highlight/before<span style='color:rgb(56,127,56);'>}{</span><span style='color:rgb(40,56,175);'>\a:highlight</span><span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122075r2'></a><span style='color:rgb(40,56,175);'>\AddToHook</span><span style='color:rgb(56,127,56);'>{</span>cmd/highlight/after<span style='color:rgb(56,127,56);'>}{</span><span style='color:rgb(40,56,175);'>\b:highlight</span><span style='color:rgb(56,127,56);'>}</span></pre>

</figure>
<!--  l. 90  --><p class='indent'>   The second way for hook insertion, useful for commands where we want to insert
tags also inside it’s contents, is to use the <span class='textbf'><code class='texttt'>\HLet</code></span> command. It is a variant of
the <span class='textbf'><code class='texttt'>\let</code></span> command. In contrast to <span class='textbf'><code class='texttt'>\let</code></span>, it saves the original command as
<span class='textbf'><code class='texttt'>\o:&lt;command name&gt;:</code></span>. Commands redefined by <span class='textbf'><code class='texttt'>\HLet</code></span> also support the <span class='textbf'><code class='texttt'>\Picture</code></span>
command, where the original version of the command will be used. This way,
pictures will produce the same result as they would produce in the PDF
mode.
</p><!--  l. 98  --><p class='indent'>   In our example, we redefined the <span class='textbf'><code class='texttt'>\note</code></span> command to use a hook between
note title and note text. This enables us to style both the title and the text
differently.
</p><!--  l. 102  --><p class='indent'>   The configuration file for our hooks could look like this:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb184'><a id='x11-122088r1'></a><span style='color:rgb(40,56,175);'>\Preamble</span><span style='color:rgb(56,127,56);'>{</span>xhtml<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122090r2'></a><span style='color:rgb(40,56,175);'>\Configure</span><span style='color:rgb(56,127,56);'>{</span>note<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122092r3'></a><span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\ifvmode\IgnorePar\fi\EndP\HCode</span><span style='color:rgb(56,127,56);'>{</span>&lt;div class="note"&gt;&lt;span class="notetitle"&gt;<span style='color:rgb(56,127,56);'>}}</span> 
<a id='x11-122094r4'></a><span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\HCode</span><span style='color:rgb(56,127,56);'>{</span>&lt;/span&gt;&lt;span class="notebody"&gt;<span style='color:rgb(56,127,56);'>}}</span> 
<a id='x11-122096r5'></a><span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\HCode</span><span style='color:rgb(56,127,56);'>{</span>&lt;/span&gt;&lt;/div&gt;<span style='color:rgb(56,127,56);'>}}</span> 
<a id='x11-122098r6'></a><span style='color:rgb(40,56,175);'>\Css</span><span style='color:rgb(56,127,56);'>{</span>.notetitle<span style='color:rgb(56,127,56);'>{</span>font-weight: bold;<span style='color:rgb(56,127,56);'>}}</span> 
<a id='x11-122100r7'></a> 
<a id='x11-122102r8'></a><span style='color:rgb(40,56,175);'>\Configure</span><span style='color:rgb(56,127,56);'>{</span>highlight<span style='color:rgb(56,127,56);'>}{</span><span style='color:rgb(40,56,175);'>\HCode</span><span style='color:rgb(56,127,56);'>{</span>&lt;span class="highlight"&gt;<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\NoFonts</span><span style='color:rgb(56,127,56);'>}{</span><span style='color:rgb(40,56,175);'>\EndNoFonts\HCode</span><span style='color:rgb(56,127,56);'>{</span>&lt;/span&gt;<span style='color:rgb(56,127,56);'>}}</span> 
<a id='x11-122104r9'></a><span style='color:rgb(40,56,175);'>\Css</span><span style='color:rgb(56,127,56);'>{</span>.highlight<span style='color:rgb(56,127,56);'>{</span>font-weight:bold;<span style='color:rgb(56,127,56);'>}}</span> 
<a id='x11-122106r10'></a><span style='color:rgb(40,56,175);'>\begin</span><span style='color:rgb(56,127,56);'>{</span>document<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-122108r11'></a><span style='color:rgb(40,56,175);'>\EndPreamble</span></pre>

</figure>
<!--  l. 118  --><p class='indent'>   As the <span class='textbf'><code class='texttt'>\note</code></span> command should be used on it’s own paragraph, we need to fix
paragraph closing. See the <a href='Configurations.html#paragraph-handling'>Paragraph Handling<!--  tex4ht:ref: sec:paragraph_handling   --></a> section for more information about
this issue. More details about configuration files and configurations are in section
<a href='Configurations.html#private-configuration-files'>Private Configuration Files<!--  tex4ht:ref: sec:private-configuration   --></a>.
</p><!--  l. 123  --><p class='indent'>   The HTML code produced by our configuration looks like this:
</p>   
<figure class='htmlsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb185'><a id='x11-122113r1'></a><span style='color:rgb(135,135,135);'>&lt;</span><span style='color:rgb(40,56,175);'>div </span><span style='color:rgb(56,127,56);'>class</span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(183,56,56);'>'note'</span><span style='color:rgb(135,135,135);'>&gt;&lt;</span><span style='color:rgb(40,56,175);'>span </span><span style='color:rgb(56,127,56);'>class</span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(183,56,56);'>'notetitle'</span><span style='color:rgb(135,135,135);'>&gt;</span>Note: <span style='color:rgb(135,135,135);'>&lt;/</span><span style='color:rgb(40,56,175);'>span</span><span style='color:rgb(135,135,135);'>&gt;&lt;</span><span style='color:rgb(40,56,175);'>span </span><span style='color:rgb(56,127,56);'>class</span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(183,56,56);'>'notebody'</span><span style='color:rgb(135,135,135);'>&gt;</span> This is a note<span style='color:rgb(135,135,135);'>&lt;/</span><span style='color:rgb(40,56,175);'>span</span><span style='color:rgb(135,135,135);'>&gt;&lt;/</span><span style='color:rgb(40,56,175);'>div</span><span style='color:rgb(135,135,135);'>&gt;</span> 
<a id='x11-122115r2'></a><span style='color:rgb(135,135,135);'><span class='textit'>&lt;!--  l. 6  --&gt;</span></span><span style='color:rgb(135,135,135);'>&lt;</span><span style='color:rgb(40,56,175);'>p </span><span style='color:rgb(56,127,56);'>class</span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(183,56,56);'>'indent'</span><span style='color:rgb(135,135,135);'>&gt;</span>   Try to highlight <span style='color:rgb(135,135,135);'>&lt;</span><span style='color:rgb(40,56,175);'>span </span><span style='color:rgb(56,127,56);'>class</span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(183,56,56);'>'highlight'</span><span style='color:rgb(135,135,135);'>&gt;</span>something<span style='color:rgb(135,135,135);'>&lt;/</span><span style='color:rgb(40,56,175);'>span</span><span style='color:rgb(135,135,135);'>&gt;</span>. 
<a id='x11-122117r3'></a><span style='color:rgb(135,135,135);'>&lt;/</span><span style='color:rgb(40,56,175);'>p</span><span style='color:rgb(135,135,135);'>&gt;</span></pre>

</figure>   

<h3 class='sectionHead' id='commands-usable-in-the-ht-files'><span class='titlemark'>10.2   </span> <a id='x11-12300010.2'></a>Commands Usable in the <code class='texttt'>.4ht</code> files</h3>
<!--  l. 134  --><p class='noindent'><code class='texttt'><span class='textbf'>\NewConfigure</span></code>{<span class='textit'>name</span>}{<span class='textit'>number of defined hooks</span>}
</p><!--  l. 136  --><p class='indent'>   This command defines macros with an alphabetic prefix in the form of <span class='textbf'><code class='texttt'>\a:name</code></span>
…<span class='textbf'><code class='texttt'>\i:name</code></span>, depending on the number of defined hooks. The maximum number is
9.
                                                                  

                                                                  
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb186'><a id='x11-123007r1'></a><span style='color:rgb(40,56,175);'>\NewConfigure</span><span style='color:rgb(56,127,56);'>{</span>try<span style='color:rgb(56,127,56);'>}{</span>2<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123009r2'></a><span style='color:rgb(40,56,175);'>\def\try</span>#1<span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\a:try</span>#1<span style='color:rgb(40,56,175);'>\b:try</span><span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123011r3'></a><span style='color:rgb(40,56,175);'>\Configure</span><span style='color:rgb(56,127,56);'>{</span>try<span style='color:rgb(56,127,56);'>}{</span>* <span style='color:rgb(56,127,56);'>}{}</span> 
<a id='x11-123013r4'></a><span style='color:rgb(40,56,175);'>\try</span><span style='color:rgb(56,127,56);'>{</span>ho<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123015r5'></a><span style='color:rgb(135,135,135);'><span class='textit'>% produces "* ho"</span></span></pre>

</figure>
<!--  l. 148  --><p class='noindent'><code class='texttt'><span class='textbf'>\NewConfigure</span></code>{<span class='textit'>name</span>}[<span class='textit'>number or parameters</span>]{<span class='textit'>code</span>}
</p><!--  l. 150  --><p class='indent'>   Variant of <span class='textbf'><code class='texttt'>\NewConfigure</code></span> that doesn’t define hooks with alphabetic
prefixes, but it passes arguments of <span class='textbf'><code class='texttt'>\Configure</code></span> as TeX arguments. See this
exampe:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb187'><a id='x11-123022r1'></a><span style='color:rgb(40,56,175);'>\NewConfigure</span><span style='color:rgb(56,127,56);'>{</span>try<span style='color:rgb(56,127,56);'>}</span>[2]<span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\def\hookI</span><span style='color:rgb(56,127,56);'>{</span>#1<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\def\hookII</span><span style='color:rgb(56,127,56);'>{</span>#2<span style='color:rgb(56,127,56);'>}}</span> 
<a id='x11-123024r2'></a><span style='color:rgb(40,56,175);'>\def\try</span>#1<span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\hookI</span>#1<span style='color:rgb(40,56,175);'>\hookII</span><span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123026r3'></a><span style='color:rgb(40,56,175);'>\Configure</span><span style='color:rgb(56,127,56);'>{</span>try<span style='color:rgb(56,127,56);'>}{</span>* <span style='color:rgb(56,127,56);'>}{}</span> 
<a id='x11-123028r4'></a><span style='color:rgb(40,56,175);'>\try</span><span style='color:rgb(56,127,56);'>{</span>ho<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123030r5'></a><span style='color:rgb(135,135,135);'><span class='textit'>% produces "* ho"</span></span></pre>

</figure>
<!--  l. 162  --><p class='indent'>   When you use <code class='texttt'>\Configure{try}</code>, it defines <span class='textbf'><code class='texttt'>\hookI</code></span> and <span class='textbf'><code class='texttt'>\hookII</code></span> commands.
They can be then used in the redefined <span class='textbf'><code class='texttt'>\try</code></span> command.
</p><!--  l. 165  --><p class='noindent'><code class='texttt'><span class='textbf'>\HLet</span></code>{<span class='textit'>Redefined command name</span>}{<span class='textit'>new command</span>}
</p><!--  l. 167  --><p class='indent'>   Variant of <span class='textbf'><code class='texttt'>\let</code></span> that saves the original command under <span class='textbf'><code class='texttt'>\ø:&lt;name&gt;:</code></span>
name. It can detect use of the redefined command inside picture. In such
case, it will use the original command to produce correct visual result in the
picture.
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb188'><a id='x11-123038r1'></a><span style='color:rgb(40,56,175);'>\NewConfigure</span><span style='color:rgb(56,127,56);'>{</span>note<span style='color:rgb(56,127,56);'>}{</span>3<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123040r2'></a><span style='color:rgb(40,56,175);'>\def\:tempa</span>#1<span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\a:note</span> note:<span style='color:rgb(40,56,175);'>\b:note</span>~#1<span style='color:rgb(40,56,175);'>\c:note</span><span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123042r3'></a><span style='color:rgb(40,56,175);'>\HLet\note\:tempa</span> 
<a id='x11-123044r4'></a><span style='color:rgb(40,56,175);'>\Configure</span><span style='color:rgb(56,127,56);'>{</span>note<span style='color:rgb(56,127,56);'>}{</span>*<span style='color:rgb(56,127,56);'>}{</span>*<span style='color:rgb(56,127,56);'>}{</span>*<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123046r5'></a><span style='color:rgb(40,56,175);'>\note</span><span style='color:rgb(56,127,56);'>{</span>hello<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123048r6'></a><span style='color:rgb(135,135,135);'><span class='textit'>% produces: "* note:* hello*</span></span></pre>

</figure>
<!--  l. 180  --><p class='noindent'><code class='texttt'><span class='textbf'>\HRestore</span></code>{<span class='textit'>command name</span>}
</p><!--  l. 182  --><p class='indent'>   Restore command redefined using <span class='textbf'><code class='texttt'>\HLet</code></span> to it’s original content.
</p><!--  l. 184  --><p class='noindent'><code class='texttt'><span class='textbf'>\pend:def&lt;X&gt;</span></code>{<span class='textit'>redefined command</span>}{<span class='textit'>code to be inserted at the begin</span>}
</p><!--  l. 186  --><p class='noindent'><code class='texttt'><span class='textbf'>\append:def&lt;X&gt;</span></code>{<span class='textit'>redefined command</span>}{<span class='textit'>code to be inserted at the end</span>}
</p><!--  l. 188  --><p class='indent'>   These two commands inserts code before and after a redefined command. There
are several versions of these commands, depending on the number of parameters that
the redefined command expects. Number of parameters as roman number replaces
the <span class='obeylines-h'><code class='verb'>&lt;X&gt;</code></span> placeholder.
</p><!--  l. 192  --><p class='indent'>   Up to three parameters are supported.
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb189'><a id='x11-123061r1'></a><span style='color:rgb(40,56,175);'>\newcommand\bar</span><span style='color:rgb(56,127,56);'>{</span>xxx<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123063r2'></a><span style='color:rgb(40,56,175);'>\pend:def\bar</span><span style='color:rgb(56,127,56);'>{</span>*<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123065r3'></a><span style='color:rgb(40,56,175);'>\append:def\bar</span><span style='color:rgb(56,127,56);'>{</span>*<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123067r4'></a><span style='color:rgb(40,56,175);'>\bar</span> 
<a id='x11-123069r5'></a><span style='color:rgb(135,135,135);'><span class='textit'>% produces: "*xxx*"</span></span> 
<a id='x11-123071r6'></a><span style='color:rgb(40,56,175);'>\newcommand\foo</span><span style='color:rgb(56,127,56);'>[2]{</span>#1, #2<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123073r7'></a><span style='color:rgb(40,56,175);'>\pend:defII\foo</span><span style='color:rgb(56,127,56);'>{</span>*<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123075r8'></a><span style='color:rgb(40,56,175);'>\append:defII\foo</span><span style='color:rgb(56,127,56);'>{</span>*<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123077r9'></a><span style='color:rgb(40,56,175);'>\foo</span><span style='color:rgb(56,127,56);'>{</span>a<span style='color:rgb(56,127,56);'>}{</span>b<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-123079r10'></a><span style='color:rgb(135,135,135);'><span class='textit'>% produces "*a, b*"</span></span> 
<a id='x11-123081r11'></a></pre>
                                                                  

                                                                  

</figure>
<!--  l. 209  --><p class='noindent'><code class='texttt'><span class='textbf'>\:CheckOption</span></code>{<span class='textit'>option name</span>}
</p><!--  l. 210  --><p class='noindent'><code class='texttt'><span class='textbf'>\if:Option</span></code>
</p><!--  l. 212  --><p class='indent'>   Support for custom options. The <span class='textbf'><code class='texttt'>\:CheckOption</code></span> checks if the given option is
active, and <span class='textbf'><code class='texttt'>\if:Option</code></span> conditional then run true or false branch.
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb190'><a id='x11-123086r1'></a><span style='color:rgb(40,56,175);'>\:CheckOption</span><span style='color:rgb(56,127,56);'>{</span>info<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\if:Option</span> 
<a id='x11-123088r2'></a>... <span style='color:rgb(40,56,175);'>\else</span> ... 
<a id='x11-123090r3'></a><span style='color:rgb(40,56,175);'>\fi</span></pre>

</figure>   

<h3 class='sectionHead' id='two-types-of-ht-files'><span class='titlemark'>10.3   </span> <a id='x11-12400010.3'></a>Two types of .4ht files</h3>
<!--  l. 226  --><p class='noindent'>The compilation starts by opening tex4ht.sty and loading a fraction of its code. The
main purpose of this phase is to request the loading of the system at a later time (for
instance, upon reaching <code class='texttt'>\begin{document}</code>). The motivation for the late loading is
to allow TeX4ht to collect as much information as possible about the environment
requested by the source file, and help the system reshape that environment with
minimal interference from elsewhere.
</p><!--  l. 233  --><p class='indent'>   The system uses two kinds of (4ht) configuration files. The files of the first kind
mainly seed hooks into the macros loaded by the source file (for instance,
<code class='texttt'>latex.4ht</code>, <code class='texttt'>fontmath.4ht</code>, and <code class='texttt'>article.4ht</code>). The files of the second kind mainly
attach meaning to the hooks (for instance, <code class='texttt'>html4.4ht</code>, <code class='texttt'>unicode.4ht</code>, and
<code class='texttt'>mathml.4ht</code>).
</p><!--  l. 240  --><p class='indent'>   Different source files may request the loading of different style files and in
different orders. The hook seeding files are loaded in response to the loading of the
style files, and in a compatible order. Since the different style files may redefine the
syntax and semantics of macros, <code class='texttt'>TeX4ht</code> follows a similar route of defining and
redefining the hooks and their meanings.

</p>   
<h4 class='subsectionHead' id='custom-output-formats1'><span class='titlemark'>10.3.1   </span> <a id='x11-12500010.3.1'></a>Custom output formats</h4>
<!--  l. 253  --><p class='noindent'>The meaning attaching files are normally requested through option names introduced
in the <code class='texttt'>tex4ht.4ht</code> system file. It defines options for all output formats supported
by <code class='texttt'>TeX4ht</code>. For instance, <span class='emph'>html5</span>, <span class='emph'>ooffice</span> for the ODT output, <span class='emph'>tei</span>, and so
on.
</p><!--  l. 258  --><p class='indent'>   These options are passed to <code class='texttt'>TeX4ht</code> by <code class='texttt'>make4ht</code>according to the <code class='texttt'>--format</code>
command line parameter, but you can pass them also yourself.
</p><!--  l. 261  --><p class='indent'>   The user may add option names, and redefine old ones, within a new file named
<code class='texttt'>tex4ht.usr</code>.
                                                                  

                                                                  
</p><!--  l. 263  --><p class='indent'>   A new tex4ht.usr file should group references to <code class='texttt'>*.4ht</code> configuration files under
arbitrarily chosen option names. For that purpose, <span class='textbf'><code class='texttt'>\Configure</code></span> commands similar to
those provided in <code class='texttt'>tex4ht.4ht</code> should be employed. These are particularly useful if
you use custom packages that are not included in TeX distributions and thus aren’t
supported by <code class='texttt'>TeX4ht</code>.
</p><!--  l. 269  --><p class='indent'>   You can place your custom <code class='texttt'>.4ht</code> files or <code class='texttt'>tex4ht.usr</code> in your local TEXMFHOME
tree, for instance in <code class='texttt'>~/texmf/tex/latex/my4htfiles</code>.
</p><!--  l. 272  --><p class='indent'>   Location of the TEXMFHOME directory can be found using the following
command:
</p>   
<figure class='shellcommand' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb191'><a id='x11-125003r1'></a>$<span style='color:rgb(168,142,40);'> </span>kpsewhich<span style='color:rgb(168,142,40);'> </span>-var-value<span style='color:rgb(168,142,40);'> </span>TEXMFHOME</pre>

</figure>   

<h5 class='subsubsectionHead' id='example'><a id='x11-126000'></a>Example</h5>
<!--  l. 280  --><p class='noindent'>Let’s say that you have a custom package <code class='texttt'>mypackage.sty</code>:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb192'><a id='x11-126004r1'></a><span style='color:rgb(40,56,175);'>\newcommand\mycommand</span><span style='color:rgb(56,127,56);'>[1]{</span>Hello #1<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-126006r2'></a><span style='color:rgb(40,56,175);'>\endinput</span></pre>

</figure>
<!--  l. 287  --><p class='indent'>   This can be configured using the following configuration file, <code class='texttt'>mypackage.4ht</code>:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb193'><a id='x11-126013r1'></a><span style='color:rgb(40,56,175);'>\NewConfigure</span><span style='color:rgb(56,127,56);'>{</span>mycommand<span style='color:rgb(56,127,56);'>}{</span>2<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-126015r2'></a><span style='color:rgb(40,56,175);'>\pend:defI\mycommand</span><span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\a:mycommand</span><span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-126017r3'></a><span style='color:rgb(40,56,175);'>\append:defI\mycommand</span><span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\b:mycommand</span><span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-126019r4'></a><span style='color:rgb(40,56,175);'>\Hinput</span><span style='color:rgb(56,127,56);'>{</span>mypackage<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-126021r5'></a><span style='color:rgb(40,56,175);'>\endinput</span></pre>

</figure>
<!--  l. 297  --><p class='indent'>   Important command in this listing is <code class='texttt'>\Hinput{mypackage}</code>. The <span class='textbf'><code class='texttt'>\Hinput</code></span> expects
package name as it’s argument. It registers it for the latter processing in the output
format files.
</p><!--  l. 300  --><p class='indent'>   Here is a custom output format file <code class='texttt'>sample.4ht</code>:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb194'><a id='x11-126035r1'></a><span style='color:rgb(40,56,175);'>\exit:ifnot</span><span style='color:rgb(56,127,56);'>{</span>mypackage<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-126037r2'></a> 
<a id='x11-126039r3'></a><span style='color:rgb(135,135,135);'><span class='textit'>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span> 
<a id='x11-126041r4'></a><span style='color:rgb(40,56,175);'>\ConfigureHinput</span><span style='color:rgb(56,127,56);'>{</span>mypackage<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-126043r5'></a><span style='color:rgb(135,135,135);'><span class='textit'>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span> 
<a id='x11-126045r6'></a><span style='color:rgb(40,56,175);'>\Configure</span><span style='color:rgb(56,127,56);'>{</span>mycommand<span style='color:rgb(56,127,56);'>}{</span><span style='color:rgb(40,56,175);'>\HCode</span><span style='color:rgb(56,127,56);'>{</span>&lt;span class="mycommand"&gt;<span style='color:rgb(56,127,56);'>}}{</span><span style='color:rgb(40,56,175);'>\HCode</span><span style='color:rgb(56,127,56);'>{</span>&lt;/span&gt;<span style='color:rgb(56,127,56);'>}}</span> 
<a id='x11-126047r7'></a> 
<a id='x11-126049r8'></a><span style='color:rgb(135,135,135);'><span class='textit'>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span> 
<a id='x11-126051r9'></a><span style='color:rgb(40,56,175);'>\endinput\empty\empty\empty\empty\empty\empty</span> 
<a id='x11-126053r10'></a><span style='color:rgb(135,135,135);'><span class='textit'>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span> 
<a id='x11-126055r11'></a> 
<a id='x11-126057r12'></a><span style='color:rgb(40,56,175);'>\endinput</span></pre>

</figure>
<!--  l. 317  --><p class='indent'>   The <span class='textbf'><code class='texttt'>\exit:ifnot</code></span> command takes comma separated list of packages supported by
the output format file. This stops it’s loading if the currently processed package
doesn’t have configurations in the file.
</p><!--  l. 321  --><p class='indent'>   The configuration for the package is placed between <span class='textbf'><code class='texttt'>\ConfigureHinput</code></span> and
<code class='texttt'>\endinput\empty\empty\empty\empty\empty\empty</code>.
                                                                  

                                                                  
</p><!--  l. 324  --><p class='indent'>   To request the custom output format file, we need to add it to <code class='texttt'>tex4ht.usr</code>. Here
is an example that adds a new option <span class='emph'>myhtml5</span>. It is based on the code for the <span class='emph'>html5</span>
option from <code class='texttt'>tex4ht.4ht</code>:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb195'><a id='x11-126084r1'></a><span style='color:rgb(40,56,175);'>\Configure</span><span style='color:rgb(56,127,56);'>{</span>myhtml5<span style='color:rgb(56,127,56);'>}{</span><span style='color:rgb(135,135,135);'><span class='textit'>%</span></span> 
<a id='x11-126086r2'></a>   <span style='color:rgb(40,56,175);'>\:CheckOption</span><span style='color:rgb(56,127,56);'>{</span>info<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\if:Option</span> 
<a id='x11-126088r3'></a>               <span style='color:rgb(40,56,175);'>\Hinclude</span><span style='color:rgb(56,127,56);'>[*]{</span>infoht4.4ht<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\fi</span> 
<a id='x11-126090r4'></a>   <span style='color:rgb(40,56,175);'>\:CheckOption</span><span style='color:rgb(56,127,56);'>{</span>info<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\if:Option</span> 
<a id='x11-126092r5'></a>               <span style='color:rgb(40,56,175);'>\Hinclude</span><span style='color:rgb(56,127,56);'>[*]{</span>infomml.4ht<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\fi</span> 
<a id='x11-126094r6'></a>   <span style='color:rgb(40,56,175);'>\Hinclude</span><span style='color:rgb(56,127,56);'>[*]{</span>html4.4ht<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(135,135,135);'><span class='textit'>%</span></span> 
<a id='x11-126096r7'></a>   <span style='color:rgb(40,56,175);'>\Hinclude</span><span style='color:rgb(56,127,56);'>[*]{</span>unicode.4ht<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(135,135,135);'><span class='textit'>%</span></span> 
<a id='x11-126098r8'></a>   <span style='color:rgb(40,56,175);'>\:CheckOption</span><span style='color:rgb(56,127,56);'>{</span>mathml<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\if:Option</span><span style='color:rgb(135,135,135);'><span class='textit'>%</span></span> 
<a id='x11-126100r9'></a>   <span style='color:rgb(40,56,175);'>\else\:CheckOption</span><span style='color:rgb(56,127,56);'>{</span>mathml-<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\fi</span><span style='color:rgb(135,135,135);'><span class='textit'>%</span></span> 
<a id='x11-126102r10'></a>   <span style='color:rgb(40,56,175);'>\if:Option</span><span style='color:rgb(135,135,135);'><span class='textit'>%</span></span> 
<a id='x11-126104r11'></a>      <span style='color:rgb(40,56,175);'>\Hinclude</span><span style='color:rgb(56,127,56);'>[*]{</span>mathml.4ht<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(135,135,135);'><span class='textit'>%</span></span> 
<a id='x11-126106r12'></a>      <span style='color:rgb(40,56,175);'>\Hinclude</span><span style='color:rgb(56,127,56);'>[*]{</span>html-mml.4ht<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(135,135,135);'><span class='textit'>%</span></span> 
<a id='x11-126108r13'></a>   <span style='color:rgb(40,56,175);'>\else</span> 
<a id='x11-126110r14'></a>      <span style='color:rgb(40,56,175);'>\Hinclude</span><span style='color:rgb(56,127,56);'>[*]{</span>html4-math.4ht<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(135,135,135);'><span class='textit'>%</span></span> 
<a id='x11-126112r15'></a>   <span style='color:rgb(40,56,175);'>\fi</span> 
<a id='x11-126114r16'></a>   <span style='color:rgb(40,56,175);'>\:CheckOption</span><span style='color:rgb(56,127,56);'>{</span>svg<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(135,135,135);'><span class='textit'>%</span></span> 
<a id='x11-126116r17'></a>             <span style='color:rgb(40,56,175);'>\if:Option \else\:CheckOption</span><span style='color:rgb(56,127,56);'>{</span>svg-<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\fi</span> 
<a id='x11-126118r18'></a>             <span style='color:rgb(40,56,175);'>\if:Option \else\:CheckOption</span><span style='color:rgb(56,127,56);'>{</span>svg-obj<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\fi</span> 
<a id='x11-126120r19'></a>             <span style='color:rgb(40,56,175);'>\if:Option \else\:CheckOption</span><span style='color:rgb(56,127,56);'>{</span>svg-inline<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\fi</span> 
<a id='x11-126122r20'></a>             <span style='color:rgb(40,56,175);'>\if:Option \Hinclude</span><span style='color:rgb(56,127,56);'>[*]{</span>svg-option.4ht<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(135,135,135);'><span class='textit'>%</span></span> 
<a id='x11-126124r21'></a>                        <span style='color:rgb(40,56,175);'>\:CheckOption</span><span style='color:rgb(56,127,56);'>{</span>info<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\if:Option \Hinclude</span><span style='color:rgb(56,127,56);'>[*]{</span>infosvg.4ht<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(40,56,175);'>\fi</span> 
<a id='x11-126126r22'></a>             <span style='color:rgb(40,56,175);'>\fi</span> 
<a id='x11-126128r23'></a>   <span style='color:rgb(40,56,175);'>\Hinclude</span><span style='color:rgb(56,127,56);'>[*]{</span>html5.4ht<span style='color:rgb(56,127,56);'>}</span><span style='color:rgb(135,135,135);'><span class='textit'>%</span></span> 
<a id='x11-126130r24'></a>   <span style='color:rgb(40,56,175);'>\Hinclude</span><span style='color:rgb(56,127,56);'>[*]{</span>sample.4ht<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-126132r25'></a><span style='color:rgb(56,127,56);'>}</span></pre>

</figure>
<!--  l. 356  --><p class='indent'>   It uses the <span class='textbf'><code class='texttt'>\:CheckOption</code></span> commands to detect additional options, which results
in conditional loading of various output format files using the <span class='textbf'><code class='texttt'>\Hinclude</code></span> command.
Our custom output file <code class='texttt'>sample.4ht</code> is placed at the end.
</p><!--  l. 360  --><p class='indent'>   You can then require the custom output format using this command:
</p>   
<figure class='shellcommand' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb196'><a id='x11-126135r1'></a>$<span style='color:rgb(168,142,40);'> </span>make4ht<span style='color:rgb(168,142,40);'> </span>filename.tex<span style='color:rgb(168,142,40);'> </span><span style='color:rgb(183,56,56);'>"myhtml5"</span></pre>

</figure>   

<h3 class='sectionHead' id='early-hooks-in-usepackageht'><span class='titlemark'>10.4   </span> <a id='x11-12700010.4'></a>Early Hooks in usepackage.4ht</h3>
<!--  l. 378  --><p class='noindent'>Normal <code class='texttt'>.4ht</code> files are loaded once the document preamble was processed. This is
usually desirable, as there are packages that redefine other packages commands, and
this way can prevent some possible clashes in such cases. Hovewer, sometimes we
need to fix package macros as soon as the package is loaded, in other cases, we need
to block the package from loading completely. This can be necessary when the
package causes fatal error when used.
</p><!--  l. 385  --><p class='indent'>   For these cases, <code class='texttt'>TeX4ht</code> uses a special file, <code class='texttt'>usepackage.4ht</code>, where you can
declare code that can be executed before the package is loaded.
</p><!--  l. 388  --><p class='indent'>   As it is loaded multiple times it is best to keep it short and place longer
pieces of code to a separate file. Sample code that loads such code looks like
this:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb197'><a id='x11-127003r1'></a><span style='color:rgb(40,56,175);'>\Configure</span><span style='color:rgb(56,127,56);'>{</span>PackageHooks<span style='color:rgb(56,127,56);'>}{</span>foo.sty<span style='color:rgb(56,127,56);'>}{</span>foo-hooks.4ht<span style='color:rgb(56,127,56);'>}</span></pre>

</figure>
<!--  l. 395  --><p class='indent'>   The <code class='texttt'>&lt;pkgname&gt;-hooks.4ht</code> name is usually used to distinguish this early hooks
file from the usual <code class='texttt'>.4ht</code> files. The general structure of the <code class='texttt'>&lt;pkgname&gt;-hooks.4ht</code> file
is following:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb198'><a id='x11-127010r1'></a>code to be executed before package loading 
<a id='x11-127012r2'></a> 
<a id='x11-127014r3'></a><span style='color:rgb(40,56,175);'>\:AtEndOfPackage</span><span style='color:rgb(56,127,56);'>{</span> 
<a id='x11-127016r4'></a>code to be executed after package loading 
<a id='x11-127018r5'></a><span style='color:rgb(56,127,56);'>}</span></pre>
                                                                  

                                                                  

</figure>
<!--  l. 407  --><p class='indent'>   There are two useful commands available:
</p><!--  l. 409  --><p class='noindent'><code class='texttt'><span class='textbf'>\:dontusepackage</span></code>{<span class='textit'>package name</span>} – prevent package from loading. It can be used to
disable packages that cause fatal error with <code class='texttt'>TeX4ht</code>.
</p><!--  l. 412  --><p class='noindent'><code class='texttt'><span class='textbf'>\:AtEndOfPackage</span></code>{<span class='textit'>code to be executed</span>} – execute code after the package was
loaded. Useful for redefinition of commands that can be used in the document
preamble.

</p>   
<h4 class='subsectionHead' id='execute-code-directly-in-usepackageht'><span class='titlemark'>10.4.1   </span> <a id='x11-12800010.4.1'></a>Execute Code Directly in usepackage.4ht</h4>
<!--  l. 417  --><p class='noindent'>You can also execute shorter pieces of code directly in <code class='texttt'>usepackage.4ht</code> thanks for
the new LaTeX package hooks. For example, the following code fixes catcode issues
with the <span class='obeylines-h'><code class='verb'>^</code></span> character in the <code class='texttt'>doc</code> package:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb199'><a id='x11-128004r1'></a><span style='color:rgb(40,56,175);'>\AddToHook</span><span style='color:rgb(56,127,56);'>{</span>package/doc/before<span style='color:rgb(56,127,56);'>}{</span><span style='color:rgb(40,56,175);'>\SUPOff</span><span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-128006r2'></a><span style='color:rgb(40,56,175);'>\AddToHook</span><span style='color:rgb(56,127,56);'>{</span>package/doc/after<span style='color:rgb(56,127,56);'>}{</span><span style='color:rgb(40,56,175);'>\SUPOn</span><span style='color:rgb(56,127,56);'>}</span></pre>

</figure>
<!--  l. 426  --><p class='indent'>   The <code class='texttt'>SUPOff</code> disables catcode changes to this character that <code class='texttt'>TeX4ht</code> uses in order
to insert markup for math superscripts, and <code class='texttt'>SUPOn</code> enables it again once the package
was processed.

</p>   
<h3 class='sectionHead' id='texht-literate-sources'><span class='titlemark'>10.5   </span> <a id='x11-12900010.5'></a><code class='texttt'>TeX4ht</code> literate sources</h3>
<!--  l. 432  --><p class='noindent'>To add a proper support for a new package, it is necessary to edit the <code class='texttt'>TeX4ht</code>
literate sources. All distributed <code class='texttt'>TeX4ht</code> files, including <code class='texttt'>tex4ht.sty</code> and all
<code class='texttt'>.4ht</code> files, are generated from these literate programming files. It is also the
reason why the generated files don’t contain much comments, these are in the
sources. If you want to understand how <code class='texttt'>TeX4ht</code> works, it is necessary to read
them.
</p><!--  l. 439  --><p class='indent'>   The source files are available in the  <a href='https://puszcza.gnu.org.ua/projects/tex4ht/'><code class='texttt'>TeX4ht</code> source repository</a>. You can retrieve
them using a SVN client.
</p>   
<figure class='shellcommand' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb200'><a id='x11-129004r1'></a>$<span style='color:rgb(168,142,40);'> </span>svn<span style='color:rgb(168,142,40);'> </span>checkout<span style='color:rgb(168,142,40);'> </span>https://svn.gnu.org.ua/sources/tex4ht/ 
<a id='x11-129006r2'></a>$<span style='color:rgb(168,142,40);'> </span><span style='color:rgb(56,127,56);'>cd</span><span style='color:rgb(168,142,40);'> </span>tex4ht/trunk/lit/</pre>

</figure>
                                                                  

                                                                  
<!--  l. 448  --><p class='indent'>   The configurable hooks for all packages are contained by the <code class='texttt'>tex4ht-4ht.tex</code> file.
Configurations of these hooks is placed in the output format configuration files. The
most common output format is <code class='texttt'>HTML</code>, which can be configured in <code class='texttt'>tex4ht-html4.tex</code>,
or <code class='texttt'>tex4ht-html5.tex</code> if <code class='texttt'>HTML5</code> features are used. You can also update sources for
other output formats, for example <code class='texttt'>tex4th-ooffice.tex</code> for the ODT format, or
<code class='texttt'>tex4ht-tei.tex</code> for TEI. The sources of the <code class='texttt'>tex4ht.sty</code> package are available in
<code class='texttt'>tex4ht-sty.tex</code>.
</p><!--  l. 455  --><p class='indent'>   To compile all literate sources, run the <code class='texttt'>make</code> command. You will need basic UNIX
utilities for this to succeed, as well as <code class='texttt'>m4</code> and <code class='texttt'>javac</code>. You can also compile
particular source files. Most of them can be compiled using LaTeX, but
some of them, for example <code class='texttt'>tex4ht-4ht.tex</code>, needs to be compiled using
<code class='texttt'>etex</code>.

</p>   
<h4 class='subsectionHead' id='how-to-add-support-for-a-package-to-the-texht-literate-sources'><span class='titlemark'>10.5.1   </span> <a id='x11-13000010.5.1'></a>How to add support for a package to the <code class='texttt'>TeX4ht</code> literate sources</h4>
<!--  l. 462  --><p class='noindent'>Given following package <code class='texttt'>sample.sty</code>:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb201'><a id='x11-130005r1'></a><span style='color:rgb(40,56,175);'>\ProvidesPackage</span><span style='color:rgb(56,127,56);'>{</span>sample<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-130007r2'></a><span style='color:rgb(40,56,175);'>\newcommand\hello</span><span style='color:rgb(56,127,56);'>{</span>hello<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-130009r3'></a><span style='color:rgb(40,56,175);'>\endinput</span></pre>

</figure>
<!--  l. 470  --><p class='indent'>   This simple package defines command <code class='texttt'>\hello</code>, which simply prints the word
“hello” when used in a document.
</p><!--  l. 472  --><p class='indent'>   Let’s say that we want to insert some <code class='texttt'>HTML</code> tags before and after the text content
printed by the command.
</p><!--  l. 474  --><p class='indent'>   Basic template for <code class='texttt'>tex4ht-4ht.tex</code>:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb202'><a id='x11-130021r1'></a><span style='color:rgb(40,56,175);'>\&lt;</span>sample.4ht<span style='color:rgb(40,56,175);'>\&gt;</span>&lt;&lt;&lt; 
<a id='x11-130023r2'></a><span style='color:rgb(135,135,135);'><span class='textit'>% sample.4ht (|version), generated from |jobname.tex</span></span> 
<a id='x11-130025r3'></a><span style='color:rgb(135,135,135);'><span class='textit'>% Copyright 2017 TeX Users Group</span></span> 
<a id='x11-130027r4'></a>|&lt;TeX4ht license text|&gt; 
<a id='x11-130029r5'></a><span style='color:rgb(40,56,175);'>\NewConfigure</span><span style='color:rgb(56,127,56);'>{</span>hello<span style='color:rgb(56,127,56);'>}{</span>2<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-130031r6'></a><span style='color:rgb(40,56,175);'>\pend:def\hello</span><span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\a:hello</span><span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-130033r7'></a><span style='color:rgb(40,56,175);'>\append:def\hello</span><span style='color:rgb(56,127,56);'>{</span><span style='color:rgb(40,56,175);'>\b:hello</span><span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-130035r8'></a><span style='color:rgb(40,56,175);'>\Hinput</span><span style='color:rgb(56,127,56);'>{</span>sample<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-130037r9'></a><span style='color:rgb(40,56,175);'>\endinput</span> 
<a id='x11-130039r10'></a>&gt;&gt;&gt; <span style='color:rgb(40,56,175);'>\AddFile</span><span style='color:rgb(56,127,56);'>{</span>9<span style='color:rgb(56,127,56);'>}{</span>sample<span style='color:rgb(56,127,56);'>}</span></pre>

</figure>
<!--  l. 490  --><p class='indent'>   Configuration for each package must follow this basic template. The <code class='texttt'>ProTeX</code>
system is used as system for literate programming.
</p><!--  l. 492  --><p class='indent'>   The <span class='obeylines-h'><code class='verb'>\&lt;name\&gt;&lt;&lt;&lt;code&gt;&gt;&gt;</code></span> block defines new macro which can be then called
using <code class='texttt'>|&lt;name|&gt;</code>. The license text is included in this way in the example. The
instruction to generate the <code class='texttt'>.4ht</code> file is given in the command <code class='texttt'>\AddFile{9}{sample}</code>
after the block definition. The first argument to <span class='textbf'><code class='texttt'>\AddFile</code></span> is an arbitrary
number.
</p><!--  l. 497  --><p class='indent'>   Each package configuration must include <code class='texttt'>\Hinput{packagename}</code>, in order to
load the configurations for the package.
</p><!--  l. 499  --><p class='indent'>   The command <code class='texttt'>\NewConfigure{hello}{2}</code> declares new configuration <code class='texttt'>hello</code>,
with two configurable hooks. These hooks are named <code class='texttt'>\a:hello</code> and <code class='texttt'>\b:hello</code>. The
hooks must be inserted into the <code class='texttt'>\hello</code>, which can be easily done using the
                                                                  

                                                                  
<code class='texttt'>\pend:def</code> and <code class='texttt'>\append:def</code> commands. These commands can insert code at the
beginning, respective at the end of the redefined command.
</p><!--  l. 504  --><p class='indent'>   The package name must be also included in the <code class='texttt'>mktex4ht-cnf.tex</code> file. This file
is used in the generation of the
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb203'><a id='x11-130042r1'></a><span style='color:rgb(40,56,175);'>\AddFile</span><span style='color:rgb(56,127,56);'>{</span>9<span style='color:rgb(56,127,56);'>}{</span>sample<span style='color:rgb(56,127,56);'>}</span></pre>

</figure>
<!--  l. 510  --><p class='indent'>   You can place configuration for <code class='texttt'>HTML</code> to the <code class='texttt'>tex4ht-html4.tex</code> file:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb204'><a id='x11-130048r1'></a><span style='color:rgb(40,56,175);'>\&lt;</span>configure html4 sample<span style='color:rgb(40,56,175);'>\&gt;</span>&lt;&lt;&lt; 
<a id='x11-130050r2'></a><span style='color:rgb(40,56,175);'>\Configure</span><span style='color:rgb(56,127,56);'>{</span>hello<span style='color:rgb(56,127,56);'>}{</span><span style='color:rgb(40,56,175);'>\HCode</span><span style='color:rgb(56,127,56);'>{</span>&lt;span class="hello"&gt;<span style='color:rgb(56,127,56);'>}}{</span><span style='color:rgb(40,56,175);'>\HCode</span><span style='color:rgb(56,127,56);'>{</span>&lt;/span&gt;<span style='color:rgb(56,127,56);'>}}</span> 
<a id='x11-130052r3'></a><span style='color:rgb(40,56,175);'>\Css</span><span style='color:rgb(56,127,56);'>{</span>.hello<span style='color:rgb(56,127,56);'>{</span>color:red;<span style='color:rgb(56,127,56);'>}}</span> 
<a id='x11-130054r4'></a>&gt;&gt;&gt;</pre>

</figure>
<!--  l. 520  --><p class='indent'>   The <code class='texttt'>\&lt;configure html4 packagename\&gt;</code> block will produce code that
detects use of the package <code class='texttt'>packagename</code>. It then loads configurations for the
package.
</p><!--  l. 525  --><p class='indent'>   The <code class='texttt'>.4ht</code> files can be generated simply using the <code class='texttt'>make</code> command.
</p><!--  l. 527  --><p class='indent'>   The following sample TeX file:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb205'><a id='x11-130061r1'></a><span style='color:rgb(40,56,175);'>\documentclass</span><span style='color:rgb(56,127,56);'>{</span>article<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-130063r2'></a><span style='color:rgb(40,56,175);'>\usepackage</span><span style='color:rgb(56,127,56);'>{</span>sample<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-130065r3'></a><span style='color:rgb(40,56,175);'>\begin</span><span style='color:rgb(56,127,56);'>{</span>document<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-130067r4'></a>  <span style='color:rgb(40,56,175);'>\hello\</span> world. 
<a id='x11-130069r5'></a><span style='color:rgb(40,56,175);'>\end</span><span style='color:rgb(56,127,56);'>{</span>document<span style='color:rgb(56,127,56);'>}</span></pre>

</figure>
<!--  l. 538  --><p class='indent'>   Produces a following <code class='texttt'>HTML</code> code:
</p>   
<figure class='htmlsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb206'><a id='x11-130074r1'></a><span style='color:rgb(135,135,135);'><span class='textit'>&lt;!--l. 4--&gt;</span></span><span style='color:rgb(135,135,135);'>&lt;</span><span style='color:rgb(40,56,175);'>p </span><span style='color:rgb(56,127,56);'>class</span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(183,56,56);'>"noindent" </span><span style='color:rgb(135,135,135);'>&gt;</span> 
<a id='x11-130076r2'></a><span style='color:rgb(135,135,135);'>&lt;</span><span style='color:rgb(40,56,175);'>span </span><span style='color:rgb(56,127,56);'>class</span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(183,56,56);'>"hello"</span><span style='color:rgb(135,135,135);'>&gt;</span>hello<span style='color:rgb(135,135,135);'>&lt;/</span><span style='color:rgb(40,56,175);'>span</span><span style='color:rgb(135,135,135);'>&gt;</span> world. 
<a id='x11-130078r3'></a><span style='color:rgb(135,135,135);'>&lt;/</span><span style='color:rgb(40,56,175);'>p</span><span style='color:rgb(135,135,135);'>&gt;</span></pre>

</figure>   

<h3 class='sectionHead' id='protex'><span class='titlemark'>10.6   </span> <a id='x11-13100010.6'></a>ProTeX</h3>
<!--  l. 552  --><p class='noindent'>The literate programming system used in the previous section is called ProTeX. We
should discuss some main ideas behind this system.
</p><!--  l. 558  --><p class='indent'>   Literate programming is a discipline that promotes the writing of programs the
way one explains them to human beings. ProTeX is a literate programming system
fully implemented in terms of TeX, and it is compatible with LaTeX and other
TeX-base systems. TeX4ht, and ProTeX itself, are examples of applications written in
ProTeX.
</p>   
<figure class='texsource' role='doc-example'>
                                                                  

                                                                  
<pre class='fancyvrb' id='fancyvrb207'><a id='x11-131009r1'></a><span style='color:rgb(40,56,175);'>\input</span> ProTex.sty 
<a id='x11-131011r2'></a><span style='color:rgb(40,56,175);'>\AlProTex</span><span style='color:rgb(56,127,56);'>{</span>extension,&lt;&lt;&lt;&gt;&gt;&gt;,list,title,escape-character<span style='color:rgb(56,127,56);'>}</span> 
<a id='x11-131013r3'></a><span style='color:rgb(40,56,175);'>\&lt;</span>title<span style='color:rgb(40,56,175);'>\&gt;</span>&lt;&lt;&lt; 
<a id='x11-131015r4'></a>code fragment 
<a id='x11-131017r5'></a>&gt;&gt;&gt; 
<a id='x11-131019r6'></a>|&lt;title|&gt; 
<a id='x11-131021r7'></a><span style='color:rgb(40,56,175);'>\OutputCode\&lt;</span>...<span style='color:rgb(40,56,175);'>\&gt;</span></pre>

</figure>
<!--  l. 575  --><p class='indent'>   Some explanation:
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb208'><a id='x11-131025r1'></a><span style='color:rgb(40,56,175);'>\input</span> ProTex.sty 
<a id='x11-131027r2'></a><span style='color:rgb(40,56,175);'>\AlProTex</span><span style='color:rgb(56,127,56);'>{</span>extension,&lt;&lt;&lt;&gt;&gt;&gt;,list,title,escape-character<span style='color:rgb(56,127,56);'>}</span></pre>

</figure>
<!--  l. 582  --><p class='indent'>   The escape-character stands for ‘, @, |, or ?. If omitted, it stands for
<span class='obeylines-h'><code class='verb'>|</code></span>.
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb209'><a id='x11-131033r1'></a><span style='color:rgb(40,56,175);'>\&lt;</span>title<span style='color:rgb(40,56,175);'>\&gt;</span>&lt;&lt;&lt; 
<a id='x11-131035r2'></a>code fragment 
<a id='x11-131037r3'></a>&gt;&gt;&gt; 
<a id='x11-131039r4'></a></pre>

</figure>
<!--  l. 591  --><p class='indent'>   This structure provides names to code fragments (the fragments should not be
too large in size).
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb210'><a id='x11-131042r1'></a> |&lt;title|&gt;</pre>

</figure>
<!--  l. 598  --><p class='indent'>   This command acts as a place holder for the code segment associated to the title
(<code class='texttt'>|</code> stands for the escape character).
</p>   
<figure class='texsource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb211'><a id='x11-131045r1'></a>   <span style='color:rgb(40,56,175);'>\OutputCode\&lt;</span>...<span style='color:rgb(40,56,175);'>\&gt;</span></pre>

</figure>
<!--  l. 604  --><p class='indent'>   This command creates a file for the code whose root node is specified.
                                                                  

                                                                  
</p>   
<nav class='crosslinks-bottom'>[<a href='FAQandTroubleshooting.html'>prev</a>] [<a href='tex4ht-doc.html#ForDevelopers.html'>up</a>] [<a href='Glossary.html'>next</a>] </nav>  </main><p><script data-goatcounter='https://kodymirus.goatcounter.com/count' src='/js/libs/goatcounter.js'></script> 
 
</p></body> 
</html>