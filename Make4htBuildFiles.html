<!DOCTYPE html> 
<html lang='en' xml:lang='en'> 
<head><title>8 Make4ht Build Files</title> 
<meta charset='utf-8' /> 
<meta content='TeX4ht (https://tug.org/tex4ht/)' name='generator' /> 
<meta content='width=device-width,initial-scale=1' name='viewport' /> 
<link href='tex4ht-doc.css' rel='stylesheet' type='text/css' /> 
<meta content='tex4ht-doc.tex' name='src' /> 
<link href='style.css' rel='stylesheet' type='text/css' /> 
</head><body>
<nav class='TOC'>   
<span class='chapterToc'>1 <a href='Introduction.html#introduction'>Introduction</a></span>

<span class='chapterToc'>2 <a href='BasicTutorial.html#basic-tutorial'>Basic Tutorial</a></span>













<span class='chapterToc'>3 <a href='Howto.html#how-to'>How to</a></span>























<span class='chapterToc'>4 <a href='CallingCommands.html#calling-commands'>Calling Commands</a></span>



                                                                  

                                                                  




<span class='chapterToc'>5 <a href='OutputFormats.html#output-formats'>Output Formats</a></span>
<span class='chapterToc'>6 <a href='texfourhtOptions.html#texht-options1'><code class='texttt'>TeX4ht</code> Options</a></span>


<span class='chapterToc'>7 <a href='Configurations.html#configurations2'>Configurations</a></span>





































                                                                  

                                                                  











<span class='chapterToc'>8 <a href='#makeht-build-files'>Make4ht Build Files</a></span>
<span class='sectionToc'>8.1 <a href='#commands-execution'>Commands execution</a></span>
<span class='sectionToc'>8.2 <a href='#filters'>Filters</a></span>
<span class='sectionToc'>8.3 <a href='#image-conversion'>Image conversion</a></span>
<span class='chapterToc'>9 <a href='FAQandTroubleshooting.html#faq-and-troubleshooting'>FAQ and Troubleshooting</a></span>







<span class='chapterToc'>10 <a href='ForDevelopers.html#for-developers'>For Developers</a></span>









<span class='chapterToc'>11 <a href='Glossary.html#glossary'>Glossary</a></span>
<span class='chapterToc'>12 <a href='Bibliography.html#bibliography'>Bibliography</a></span>
<span class='chapterToc'>13 <a href='Index.html#index'>Index</a></span>
<span class='chapterToc'>14 <a href='Changes.html#changes'>Changes</a></span>
 
   
</nav> 
<main class='main-content'> 
<nav class='crosslinks-top'> [<a href='Configurations.html'>prev</a>] [<a href='tex4ht-doc.html#Make4htBuildFiles.html'>up</a>] [<a href='FAQandTroubleshooting.html'>next</a>] </nav> 
<h2 class='chapterHead' id='makeht-build-files'><span class='titlemark'>Chapter 8</span><br /><a id='x9-1090008'></a>Make4ht Build Files</h2>
   
<h3 class='sectionHead' id='commands-execution'><span class='titlemark'>8.1   </span> <a id='x9-1100008.1'></a>Commands execution</h3>
<!--  l. 5  --><p class='noindent'>The following example uses a custom command, <code class='texttt'>myhtlatex</code>, to determine if the
document needs a recompilation. It makes MD5 checksum of temporary files used by
<code class='texttt'>TeX4ht</code>, before and after the compilation.
                                                                  

                                                                  
</p><!--  l. 9  --><p class='indent'>   It checksums differ, new sections or labels were added to the document, and more
LaTeX compilations may be necessary to ger correct hyperlinks. The script will
execute LaTeX again, until checksums donâ€™t change.
</p>   
<figure class='luasource' role='doc-example'>
<pre class='fancyvrb' id='fancyvrb162'><a id='x9-110046r1'></a><span style='color:rgb(40,56,175);'><span class='textit'>local</span></span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>htlatex</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(56,127,56);'>require</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(183,56,56);'>"make4ht-htlatex"</span> 
<a id='x9-110048r2'></a> 
<a id='x9-110050r3'></a><span style='color:rgb(40,56,175);'><span class='textit'>local</span></span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>function</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(119,89,63);'>get_checksum</span><span style='color:rgb(135,135,135);'>(</span><span style='color:rgb(175,63,63);'>main_file</span><span style='color:rgb(135,135,135);'>,</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>extensions</span><span style='color:rgb(135,135,135);'>)</span> 
<a id='x9-110052r4'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(135,135,135);'><span class='textit'>-- make checksum for temporary files</span></span> 
<a id='x9-110054r5'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'><span class='textit'>local</span></span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>checksum</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(183,56,56);'>""</span> 
<a id='x9-110056r6'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'><span class='textit'>local</span></span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>extensions</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>extensions</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(168,71,168);'>or</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(135,135,135);'>{</span><span style='color:rgb(183,56,56);'>"aux"</span><span style='color:rgb(135,135,135);'>,</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(183,56,56);'>"4tc"</span><span style='color:rgb(135,135,135);'>,</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(183,56,56);'>"xref"</span><span style='color:rgb(135,135,135);'>}</span> 
<a id='x9-110058r7'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'>for</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>_</span><span style='color:rgb(135,135,135);'>,</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>ext</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>in</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(56,127,56);'>ipairs</span><span style='color:rgb(135,135,135);'>(</span><span style='color:rgb(175,63,63);'>extensions</span><span style='color:rgb(135,135,135);'>)</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>do</span> 
<a id='x9-110060r8'></a><span style='color:rgb(168,142,40);'>    </span><span style='color:rgb(40,56,175);'><span class='textit'>local</span></span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>f</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(56,127,56);'>io.open</span><span style='color:rgb(135,135,135);'>(</span><span style='color:rgb(175,63,63);'>main_file</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>..</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(183,56,56);'>"."</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>..</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>ext</span><span style='color:rgb(135,135,135);'>,</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(183,56,56);'>"r"</span><span style='color:rgb(135,135,135);'>)</span> 
<a id='x9-110062r9'></a><span style='color:rgb(168,142,40);'>    </span><span style='color:rgb(40,56,175);'>if</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>f</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>then</span> 
<a id='x9-110064r10'></a><span style='color:rgb(168,142,40);'>      </span><span style='color:rgb(40,56,175);'><span class='textit'>local</span></span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>content</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>f</span><span style='color:rgb(135,135,135);'>:</span><span style='color:rgb(119,89,63);'>read</span><span style='color:rgb(135,135,135);'>(</span><span style='color:rgb(183,56,56);'>"*all"</span><span style='color:rgb(135,135,135);'>)</span> 
<a id='x9-110066r11'></a><span style='color:rgb(168,142,40);'>      </span><span style='color:rgb(175,63,63);'>f</span><span style='color:rgb(135,135,135);'>:</span><span style='color:rgb(119,89,63);'>close</span><span style='color:rgb(135,135,135);'>()</span> 
<a id='x9-110068r12'></a><span style='color:rgb(168,142,40);'>      </span><span style='color:rgb(135,135,135);'><span class='textit'>-- make checksum of the file and previous checksum</span></span> 
<a id='x9-110070r13'></a><span style='color:rgb(168,142,40);'>      </span><span style='color:rgb(135,135,135);'><span class='textit'>-- this way, we will detect change in any file</span></span> 
<a id='x9-110072r14'></a><span style='color:rgb(168,142,40);'>      </span><span style='color:rgb(175,63,63);'>checksum</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>md5</span><span style='color:rgb(135,135,135);'>.</span><span style='color:rgb(119,89,63);'>sumhexa</span><span style='color:rgb(135,135,135);'>(</span><span style='color:rgb(175,63,63);'>checksum</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>..</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>content</span><span style='color:rgb(135,135,135);'>)</span> 
<a id='x9-110074r15'></a><span style='color:rgb(168,142,40);'>    </span><span style='color:rgb(40,56,175);'>end</span> 
<a id='x9-110076r16'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'>end</span> 
<a id='x9-110078r17'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'>return</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>checksum</span> 
<a id='x9-110080r18'></a><span style='color:rgb(40,56,175);'>end</span> 
<a id='x9-110082r19'></a> 
<a id='x9-110084r20'></a><span style='color:rgb(175,63,63);'>Make</span><span style='color:rgb(135,135,135);'>:</span><span style='color:rgb(119,89,63);'>add</span><span style='color:rgb(135,135,135);'>(</span><span style='color:rgb(183,56,56);'>"myhtlatex"</span><span style='color:rgb(135,135,135);'>,</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>function</span><span style='color:rgb(135,135,135);'>(</span><span style='color:rgb(175,63,63);'>par</span><span style='color:rgb(135,135,135);'>)</span> 
<a id='x9-110086r21'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(135,135,135);'><span class='textit'>-- get checksum of temp files before compilation</span></span> 
<a id='x9-110088r22'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'><span class='textit'>local</span></span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>checksum</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(119,89,63);'>get_checksum</span><span style='color:rgb(135,135,135);'>(</span><span style='color:rgb(175,63,63);'>par</span><span style='color:rgb(135,135,135);'>.</span>input<span style='color:rgb(135,135,135);'>)</span> 
<a id='x9-110090r23'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'><span class='textit'>local</span></span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>status</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>htlatex</span><span style='color:rgb(135,135,135);'>.</span><span style='color:rgb(119,89,63);'>htlatex</span><span style='color:rgb(135,135,135);'>(</span><span style='color:rgb(175,63,63);'>par</span><span style='color:rgb(135,135,135);'>)</span> 
<a id='x9-110092r24'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(135,135,135);'><span class='textit'>-- stop processing on error</span></span> 
<a id='x9-110094r25'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'>if</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>status</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>~=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(68,68,68);'>0</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>then</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>return</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>status</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>end</span> 
<a id='x9-110096r26'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(135,135,135);'><span class='textit'>-- get checksum after compilation</span></span> 
<a id='x9-110098r27'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'><span class='textit'>local</span></span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>newchecksum</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(119,89,63);'>get_checksum</span><span style='color:rgb(135,135,135);'>(</span><span style='color:rgb(175,63,63);'>par</span><span style='color:rgb(135,135,135);'>.</span>input<span style='color:rgb(135,135,135);'>)</span> 
<a id='x9-110100r28'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(135,135,135);'><span class='textit'>-- this is needed to prevent possible infinite loops</span></span> 
<a id='x9-110102r29'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'><span class='textit'>local</span></span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>compilation_count</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(68,68,68);'>1</span> 
<a id='x9-110104r30'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'><span class='textit'>local</span></span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>max_compilations</span><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(68,68,68);'>3</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(135,135,135);'><span class='textit'>-- &lt;- change as you want</span></span> 
<a id='x9-110106r31'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'>while</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>checksum</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>~=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>newchecksum</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>do</span> 
<a id='x9-110108r32'></a><span style='color:rgb(168,142,40);'>    </span><span style='color:rgb(135,135,135);'><span class='textit'>--</span></span> 
<a id='x9-110110r33'></a><span style='color:rgb(168,142,40);'>    </span><span style='color:rgb(40,56,175);'>if</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>compilation_count</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>&gt;</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>max_compilations</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>then</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>return</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>status</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>end</span> 
<a id='x9-110112r34'></a><span style='color:rgb(168,142,40);'>    </span><span style='color:rgb(175,63,63);'>status</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>htlatex</span><span style='color:rgb(135,135,135);'>.</span><span style='color:rgb(119,89,63);'>htlatex</span><span style='color:rgb(135,135,135);'>(</span><span style='color:rgb(175,63,63);'>par</span><span style='color:rgb(135,135,135);'>)</span> 
<a id='x9-110114r35'></a><span style='color:rgb(168,142,40);'>    </span><span style='color:rgb(135,135,135);'><span class='textit'>-- stop processing on error</span></span> 
<a id='x9-110116r36'></a><span style='color:rgb(168,142,40);'>    </span><span style='color:rgb(40,56,175);'>if</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>status</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>~=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(68,68,68);'>0</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>then</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>return</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>status</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(40,56,175);'>end</span> 
<a id='x9-110118r37'></a><span style='color:rgb(168,142,40);'>    </span><span style='color:rgb(175,63,63);'>checksum</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>newchecksum</span> 
<a id='x9-110120r38'></a><span style='color:rgb(168,142,40);'>    </span><span style='color:rgb(135,135,135);'><span class='textit'>-- get checksum after compilation</span></span> 
<a id='x9-110122r39'></a><span style='color:rgb(168,142,40);'>    </span><span style='color:rgb(175,63,63);'>newchecksum</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(119,89,63);'>get_checksum</span><span style='color:rgb(135,135,135);'>(</span><span style='color:rgb(175,63,63);'>par</span><span style='color:rgb(135,135,135);'>.</span>input<span style='color:rgb(135,135,135);'>)</span> 
<a id='x9-110124r40'></a><span style='color:rgb(168,142,40);'>    </span><span style='color:rgb(175,63,63);'>compilation_count</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>=</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>compilation_count</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(101,101,101);'>+</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(68,68,68);'>1</span> 
<a id='x9-110126r41'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'>end</span> 
<a id='x9-110128r42'></a><span style='color:rgb(168,142,40);'>  </span><span style='color:rgb(40,56,175);'>return</span><span style='color:rgb(168,142,40);'> </span><span style='color:rgb(175,63,63);'>status</span> 
<a id='x9-110130r43'></a><span style='color:rgb(40,56,175);'>end</span><span style='color:rgb(135,135,135);'>)</span> 
<a id='x9-110132r44'></a><span style='color:rgb(175,63,63);'>Make</span><span style='color:rgb(135,135,135);'>:</span>myhtlatex<span style='color:rgb(168,142,40);'> </span><span style='color:rgb(135,135,135);'>{}</span></pre>

</figure>   

<h3 class='sectionHead' id='filters'><span class='titlemark'>8.2   </span> <a id='x9-1110008.2'></a>Filters</h3>
<!--  l. 63  --><p class='noindent'>Some samples:
</p>     
<ul class='itemize1'>
<li class='itemize'>Render      math      by      Mathjax      during      tex4ht      compilation
<a class='url' href='https://tex.stackexchange.com/a/402159/2891'><span class='rm-lmtt-10'>https://tex.stackexchange.com/a/402159/2891</span></a></li></ul>
   
<h3 class='sectionHead' id='image-conversion'><span class='titlemark'>8.3   </span> <a id='x9-1120008.3'></a>Image conversion</h3>
                                                                  

                                                                  
<nav class='crosslinks-bottom'>[<a href='Configurations.html'>prev</a>] [<a href='tex4ht-doc.html#Make4htBuildFiles.html'>up</a>] [<a href='FAQandTroubleshooting.html'>next</a>] </nav>  </main><p><script data-goatcounter='https://kodymirus.goatcounter.com/count' src='/js/libs/goatcounter.js'></script> 
 
</p></body> 
</html>